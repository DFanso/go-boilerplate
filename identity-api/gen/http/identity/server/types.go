// Code generated by goa v3.23.4, DO NOT EDIT.
//
// identity HTTP server types
//
// Command:
// $ goa gen github.com/vidwadeseram/go-boilerplate/identity-api/design

package server

import (
	"unicode/utf8"

	identity "github.com/vidwadeseram/go-boilerplate/identity-api/gen/identity"
	identityviews "github.com/vidwadeseram/go-boilerplate/identity-api/gen/identity/views"
	goa "goa.design/goa/v3/pkg"
)

// RegisterRequestBody is the type of the "identity" service "register"
// endpoint HTTP request body.
type RegisterRequestBody struct {
	DisplayName *string `form:"display_name,omitempty" json:"display_name,omitempty" xml:"display_name,omitempty"`
	Email       *string `form:"email,omitempty" json:"email,omitempty" xml:"email,omitempty"`
	Password    *string `form:"password,omitempty" json:"password,omitempty" xml:"password,omitempty"`
}

// LoginRequestBody is the type of the "identity" service "login" endpoint HTTP
// request body.
type LoginRequestBody struct {
	Email    *string `form:"email,omitempty" json:"email,omitempty" xml:"email,omitempty"`
	Password *string `form:"password,omitempty" json:"password,omitempty" xml:"password,omitempty"`
}

// ValidateTokenRequestBody is the type of the "identity" service
// "validate_token" endpoint HTTP request body.
type ValidateTokenRequestBody struct {
	// JWT access token
	Token *string `form:"token,omitempty" json:"token,omitempty" xml:"token,omitempty"`
}

// RegisterResponseBody is the type of the "identity" service "register"
// endpoint HTTP response body.
type RegisterResponseBody struct {
	// User identifier
	ID string `form:"id" json:"id" xml:"id"`
	// Email address
	Email string `form:"email" json:"email" xml:"email"`
	// Display name
	DisplayName string `form:"display_name" json:"display_name" xml:"display_name"`
	// Creation timestamp
	CreatedAt string `form:"created_at" json:"created_at" xml:"created_at"`
}

// LoginResponseBody is the type of the "identity" service "login" endpoint
// HTTP response body.
type LoginResponseBody struct {
	// JWT access token
	AccessToken string `form:"access_token" json:"access_token" xml:"access_token"`
	// Token expiry window in seconds
	ExpiresIn int `form:"expires_in" json:"expires_in" xml:"expires_in"`
}

// ValidateTokenResponseBody is the type of the "identity" service
// "validate_token" endpoint HTTP response body.
type ValidateTokenResponseBody struct {
	Valid  bool    `form:"valid" json:"valid" xml:"valid"`
	UserID *string `form:"user_id,omitempty" json:"user_id,omitempty" xml:"user_id,omitempty"`
	Email  *string `form:"email,omitempty" json:"email,omitempty" xml:"email,omitempty"`
	Reason *string `form:"reason,omitempty" json:"reason,omitempty" xml:"reason,omitempty"`
}

// NewRegisterResponseBody builds the HTTP response body from the result of the
// "register" endpoint of the "identity" service.
func NewRegisterResponseBody(res *identityviews.UserView) *RegisterResponseBody {
	body := &RegisterResponseBody{
		ID:          *res.ID,
		Email:       *res.Email,
		DisplayName: *res.DisplayName,
		CreatedAt:   *res.CreatedAt,
	}
	return body
}

// NewLoginResponseBody builds the HTTP response body from the result of the
// "login" endpoint of the "identity" service.
func NewLoginResponseBody(res *identity.TokenResult) *LoginResponseBody {
	body := &LoginResponseBody{
		AccessToken: res.AccessToken,
		ExpiresIn:   res.ExpiresIn,
	}
	return body
}

// NewValidateTokenResponseBody builds the HTTP response body from the result
// of the "validate_token" endpoint of the "identity" service.
func NewValidateTokenResponseBody(res *identity.ValidationResult) *ValidateTokenResponseBody {
	body := &ValidateTokenResponseBody{
		Valid:  res.Valid,
		UserID: res.UserID,
		Email:  res.Email,
		Reason: res.Reason,
	}
	return body
}

// NewRegisterPayload builds a identity service register endpoint payload.
func NewRegisterPayload(body *RegisterRequestBody) *identity.RegisterPayload {
	v := &identity.RegisterPayload{
		DisplayName: *body.DisplayName,
		Email:       *body.Email,
		Password:    *body.Password,
	}

	return v
}

// NewLoginCredentials builds a identity service login endpoint payload.
func NewLoginCredentials(body *LoginRequestBody) *identity.Credentials {
	v := &identity.Credentials{
		Email:    *body.Email,
		Password: *body.Password,
	}

	return v
}

// NewValidateTokenPayload builds a identity service validate_token endpoint
// payload.
func NewValidateTokenPayload(body *ValidateTokenRequestBody) *identity.ValidateTokenPayload {
	v := &identity.ValidateTokenPayload{
		Token: *body.Token,
	}

	return v
}

// ValidateRegisterRequestBody runs the validations defined on
// RegisterRequestBody
func ValidateRegisterRequestBody(body *RegisterRequestBody) (err error) {
	if body.DisplayName == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("display_name", "body"))
	}
	if body.Email == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("email", "body"))
	}
	if body.Password == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("password", "body"))
	}
	if body.DisplayName != nil {
		if utf8.RuneCountInString(*body.DisplayName) < 3 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.display_name", *body.DisplayName, utf8.RuneCountInString(*body.DisplayName), 3, true))
		}
	}
	if body.Email != nil {
		err = goa.MergeErrors(err, goa.ValidateFormat("body.email", *body.Email, goa.FormatEmail))
	}
	if body.Password != nil {
		if utf8.RuneCountInString(*body.Password) < 8 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.password", *body.Password, utf8.RuneCountInString(*body.Password), 8, true))
		}
	}
	return
}

// ValidateLoginRequestBody runs the validations defined on LoginRequestBody
func ValidateLoginRequestBody(body *LoginRequestBody) (err error) {
	if body.Email == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("email", "body"))
	}
	if body.Password == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("password", "body"))
	}
	if body.Email != nil {
		err = goa.MergeErrors(err, goa.ValidateFormat("body.email", *body.Email, goa.FormatEmail))
	}
	if body.Password != nil {
		if utf8.RuneCountInString(*body.Password) < 8 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.password", *body.Password, utf8.RuneCountInString(*body.Password), 8, true))
		}
	}
	return
}

// ValidateValidateTokenRequestBody runs the validations defined on
// validate_token_request_body
func ValidateValidateTokenRequestBody(body *ValidateTokenRequestBody) (err error) {
	if body.Token == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("token", "body"))
	}
	return
}
