// Code generated by goa v3.23.4, DO NOT EDIT.
//
// identity gRPC client encoders and decoders
//
// Command:
// $ goa gen github.com/vidwadeseram/go-boilerplate/identity-api/design

package client

import (
	"context"

	identitypb "github.com/vidwadeseram/go-boilerplate/identity-api/gen/grpc/identity/pb"
	identity "github.com/vidwadeseram/go-boilerplate/identity-api/gen/identity"
	identityviews "github.com/vidwadeseram/go-boilerplate/identity-api/gen/identity/views"
	goagrpc "goa.design/goa/v3/grpc"
	"google.golang.org/grpc"
	"google.golang.org/grpc/metadata"
)

// BuildRegisterFunc builds the remote method to invoke for "identity" service
// "register" endpoint.
func BuildRegisterFunc(grpccli identitypb.IdentityClient, cliopts ...grpc.CallOption) goagrpc.RemoteFunc {
	return func(ctx context.Context, reqpb any, opts ...grpc.CallOption) (any, error) {
		for _, opt := range cliopts {
			opts = append(opts, opt)
		}
		if reqpb != nil {
			return grpccli.Register(ctx, reqpb.(*identitypb.RegisterRequest), opts...)
		}
		return grpccli.Register(ctx, &identitypb.RegisterRequest{}, opts...)
	}
}

// EncodeRegisterRequest encodes requests sent to identity register endpoint.
func EncodeRegisterRequest(ctx context.Context, v any, md *metadata.MD) (any, error) {
	payload, ok := v.(*identity.RegisterPayload)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "register", "*identity.RegisterPayload", v)
	}
	return NewProtoRegisterRequest(payload), nil
}

// DecodeRegisterResponse decodes responses from the identity register endpoint.
func DecodeRegisterResponse(ctx context.Context, v any, hdr, trlr metadata.MD) (any, error) {
	var view string
	{
		if vals := hdr.Get("goa-view"); len(vals) > 0 {
			view = vals[0]
		}
	}
	message, ok := v.(*identitypb.RegisterResponse)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "register", "*identitypb.RegisterResponse", v)
	}
	res := NewRegisterResult(message)
	vres := &identityviews.User{Projected: res, View: view}
	if err := identityviews.ValidateUser(vres); err != nil {
		return nil, err
	}
	return identity.NewUser(vres), nil
}

// BuildLoginFunc builds the remote method to invoke for "identity" service
// "login" endpoint.
func BuildLoginFunc(grpccli identitypb.IdentityClient, cliopts ...grpc.CallOption) goagrpc.RemoteFunc {
	return func(ctx context.Context, reqpb any, opts ...grpc.CallOption) (any, error) {
		for _, opt := range cliopts {
			opts = append(opts, opt)
		}
		if reqpb != nil {
			return grpccli.Login(ctx, reqpb.(*identitypb.LoginRequest), opts...)
		}
		return grpccli.Login(ctx, &identitypb.LoginRequest{}, opts...)
	}
}

// EncodeLoginRequest encodes requests sent to identity login endpoint.
func EncodeLoginRequest(ctx context.Context, v any, md *metadata.MD) (any, error) {
	payload, ok := v.(*identity.Credentials)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "login", "*identity.Credentials", v)
	}
	return NewProtoLoginRequest(payload), nil
}

// DecodeLoginResponse decodes responses from the identity login endpoint.
func DecodeLoginResponse(ctx context.Context, v any, hdr, trlr metadata.MD) (any, error) {
	message, ok := v.(*identitypb.LoginResponse)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "login", "*identitypb.LoginResponse", v)
	}
	res := NewLoginResult(message)
	return res, nil
}

// BuildValidateTokenFunc builds the remote method to invoke for "identity"
// service "validate_token" endpoint.
func BuildValidateTokenFunc(grpccli identitypb.IdentityClient, cliopts ...grpc.CallOption) goagrpc.RemoteFunc {
	return func(ctx context.Context, reqpb any, opts ...grpc.CallOption) (any, error) {
		for _, opt := range cliopts {
			opts = append(opts, opt)
		}
		if reqpb != nil {
			return grpccli.ValidateToken(ctx, reqpb.(*identitypb.ValidateTokenRequest), opts...)
		}
		return grpccli.ValidateToken(ctx, &identitypb.ValidateTokenRequest{}, opts...)
	}
}

// EncodeValidateTokenRequest encodes requests sent to identity validate_token
// endpoint.
func EncodeValidateTokenRequest(ctx context.Context, v any, md *metadata.MD) (any, error) {
	payload, ok := v.(*identity.ValidateTokenPayload)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "validate_token", "*identity.ValidateTokenPayload", v)
	}
	return NewProtoValidateTokenRequest(payload), nil
}

// DecodeValidateTokenResponse decodes responses from the identity
// validate_token endpoint.
func DecodeValidateTokenResponse(ctx context.Context, v any, hdr, trlr metadata.MD) (any, error) {
	message, ok := v.(*identitypb.ValidateTokenResponse)
	if !ok {
		return nil, goagrpc.ErrInvalidType("identity", "validate_token", "*identitypb.ValidateTokenResponse", v)
	}
	res := NewValidateTokenResult(message)
	return res, nil
}
