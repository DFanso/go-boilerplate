// Code generated by goa v3.23.4, DO NOT EDIT.
//
// identity service
//
// Command:
// $ goa gen github.com/vidwadeseram/go-boilerplate/identity-api/design

package identity

import (
	"context"

	identityviews "github.com/vidwadeseram/go-boilerplate/identity-api/gen/identity/views"
)

// Operations for user identities
type Service interface {
	// Registers a new user
	Register(context.Context, *RegisterPayload) (res *User, err error)
	// Authenticates a user and issues a JWT
	Login(context.Context, *Credentials) (res *TokenResult, err error)
	// Validates a JWT and returns the claims
	ValidateToken(context.Context, *ValidateTokenPayload) (res *ValidationResult, err error)
}

// APIName is the name of the API as defined in the design.
const APIName = "identity"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "0.0.1"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "identity"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [3]string{"register", "login", "validate_token"}

// Credentials is the payload type of the identity service login method.
type Credentials struct {
	Email    string
	Password string
}

type NotFoundError struct {
	// description of the failure
	Message string
	// error identifier
	ID        *string
	Temporary *bool
	Timeout   *bool
}

// RegisterPayload is the payload type of the identity service register method.
type RegisterPayload struct {
	DisplayName string
	Email       string
	Password    string
}

// TokenResult is the result type of the identity service login method.
type TokenResult struct {
	// JWT access token
	AccessToken string
	// Token expiry window in seconds
	ExpiresIn int
}

type UnauthorizedError struct {
	// description of the failure
	Message string
	// error identifier
	ID *string
	// true if the error is temporary
	Temporary *bool
	// true if the error is retryable
	Timeout *bool
}

// User is the result type of the identity service register method.
type User struct {
	// User identifier
	ID string
	// Email address
	Email string
	// Display name
	DisplayName string
	// Creation timestamp
	CreatedAt string
}

// ValidateTokenPayload is the payload type of the identity service
// validate_token method.
type ValidateTokenPayload struct {
	// JWT access token
	Token string
}

// ValidationResult is the result type of the identity service validate_token
// method.
type ValidationResult struct {
	Valid  bool
	UserID *string
	Email  *string
	Reason *string
}

// Error returns an error description.
func (e *NotFoundError) Error() string {
	return ""
}

// ErrorName returns "NotFoundError".
//
// Deprecated: Use GoaErrorName - https://github.com/goadesign/goa/issues/3105
func (e *NotFoundError) ErrorName() string {
	return e.GoaErrorName()
}

// GoaErrorName returns "NotFoundError".
func (e *NotFoundError) GoaErrorName() string {
	return "not_found"
}

// Error returns an error description.
func (e *UnauthorizedError) Error() string {
	return ""
}

// ErrorName returns "UnauthorizedError".
//
// Deprecated: Use GoaErrorName - https://github.com/goadesign/goa/issues/3105
func (e *UnauthorizedError) ErrorName() string {
	return e.GoaErrorName()
}

// GoaErrorName returns "UnauthorizedError".
func (e *UnauthorizedError) GoaErrorName() string {
	return "unauthorized"
}

// NewUser initializes result type User from viewed result type User.
func NewUser(vres *identityviews.User) *User {
	return newUser(vres.Projected)
}

// NewViewedUser initializes viewed result type User from result type User
// using the given view.
func NewViewedUser(res *User, view string) *identityviews.User {
	p := newUserView(res)
	return &identityviews.User{Projected: p, View: "default"}
}

// newUser converts projected type User to service type User.
func newUser(vres *identityviews.UserView) *User {
	res := &User{}
	if vres.ID != nil {
		res.ID = *vres.ID
	}
	if vres.Email != nil {
		res.Email = *vres.Email
	}
	if vres.DisplayName != nil {
		res.DisplayName = *vres.DisplayName
	}
	if vres.CreatedAt != nil {
		res.CreatedAt = *vres.CreatedAt
	}
	return res
}

// newUserView projects result type User to projected type UserView using the
// "default" view.
func newUserView(res *User) *identityviews.UserView {
	vres := &identityviews.UserView{
		ID:          &res.ID,
		Email:       &res.Email,
		DisplayName: &res.DisplayName,
		CreatedAt:   &res.CreatedAt,
	}
	return vres
}
